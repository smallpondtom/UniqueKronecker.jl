<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Duplication Matrix · UniqueKronecker.jl</title><meta name="title" content="Duplication Matrix · UniqueKronecker.jl"/><meta property="og:title" content="Duplication Matrix · UniqueKronecker.jl"/><meta property="twitter:title" content="Duplication Matrix · UniqueKronecker.jl"/><meta name="description" content="Documentation for UniqueKronecker.jl."/><meta property="og:description" content="Documentation for UniqueKronecker.jl."/><meta property="twitter:description" content="Documentation for UniqueKronecker.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="UniqueKronecker.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">UniqueKronecker.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Unique Kronecker Products</span><ul><li><a class="tocitem" href="../../uniquekronecker/basics/">Basics</a></li><li><a class="tocitem" href="../../uniquekronecker/higherorder/">Higher Order</a></li></ul></li><li><a class="tocitem" href="../../circulantkronecker/basics/">Circulant Kronecker Products</a></li><li><span class="tocitem">Matrix Conversions</span><ul><li><a class="tocitem" href="../dynamicalsystem/">Polynomial Dynamical System</a></li><li><a class="tocitem" href="../elimination/">Elimination Matrix</a></li><li class="is-active"><a class="tocitem" href>Duplication Matrix</a><ul class="internal"><li><a class="tocitem" href="#Definition"><span>Definition</span></a></li><li><a class="tocitem" href="#Converting-Between-Kronecker-Products"><span>Converting Between Kronecker Products</span></a></li><li><a class="tocitem" href="#Converting-Between-Operators"><span>Converting Between Operators</span></a></li></ul></li><li><a class="tocitem" href="../commutation/">Commutation Matrix</a></li><li><a class="tocitem" href="../symmetrizer/">Symmetrizer Matrix</a></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li><li><a class="tocitem" href="../../paper/">Paper Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Matrix Conversions</a></li><li class="is-active"><a href>Duplication Matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Duplication Matrix</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/smallpondtom/UniqueKronecker.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/smallpondtom/UniqueKronecker.jl/blob/https://github.com/smallpondtom/UniqueKronecker.jl/docs/src/matrices/duplication.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Duplication-Matrix"><a class="docs-heading-anchor" href="#Duplication-Matrix">Duplication Matrix</a><a id="Duplication-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Duplication-Matrix" title="Permalink"></a></h1><p>In the second-order Kronecker product sense, the duplication matrix <span>$\mathbf{D}$</span> is a matrix that transforms a vector containing only the unique elements of a symmetric matrix (vectorized in half-vectorization form) into the full vectorization of the symmetric matrix, effectively duplicating the symmetric elements to their appropriate positions. It plays a crucial role in manipulating Kronecker products and converting between non-redundant and redundant polynomial operators in polynomial dynamical systems.</p><h2 id="Definition"><a class="docs-heading-anchor" href="#Definition">Definition</a><a id="Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Definition" title="Permalink"></a></h2><p>The duplication matrix <span>$\mathbf{D}_n$</span> is a unique matrix of size <span>$\left(n^2 \times \tfrac{n(n+1)}{2}\right)$</span> defined such that for any symmetric matrix <span>$\mathbf{S} \in \mathbb{R}^{n \times n}$</span>:</p><p class="math-container">\[    \mathrm{vec}(\mathbf{S}) = \mathbf{D}_n \mathrm{vech}(\mathbf{S})\]</p><p>where: (1) <span>$\mathrm{vec}(\mathbf{S})$</span> stacks all columns of <span>$\mathbf{S}$</span> into a single vector of length <span>$n^2$</span>; (2) <span>$\mathrm{vech}(\mathbf{S})$</span> stacks only the elements on and below (or above) the main diagonal into a vector of length <span>$\tfrac{n(n+1)}{2}$</span>.</p><p>The duplication matrix effectively &quot;duplicates&quot; the unique elements in <span>$\mathrm{vech}(\mathbf{S})$</span> to fill the positions in <span>$\mathrm{vec}(\mathbf{S})$</span> that correspond to symmetric entries.</p><p><strong>Properties of the Duplication Matrix:</strong></p><ul><li><p><strong>Construction:</strong> Each column of <span>$\mathbf{D}_n$</span> contains ones at positions corresponding to the symmetric elements in <span>$\operatorname{vec}(\mathbf{S})$</span> and zeros elsewhere.</p></li><li><p><strong>Relation to Elimination Matrix:</strong> The duplication matrix is related to the elimination matrix <span>$\mathbf{L}_n$</span> via:</p><p class="math-container">\[    \mathbf{L}_n\mathbf{D}_n = \mathbf{I}_n\]</p></li></ul><p>for more definitions see <a href="../../paper/#MagnusEML1980">Magnus and Neudecker [1]</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Similar to the elimination matrix, this matrix is not formally/mathematically generalized for higher-order Kronecker products in the literature.</p></div></div><h2 id="Converting-Between-Kronecker-Products"><a class="docs-heading-anchor" href="#Converting-Between-Kronecker-Products">Converting Between Kronecker Products</a><a id="Converting-Between-Kronecker-Products-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-Between-Kronecker-Products" title="Permalink"></a></h2><p>In polynomial dynamical systems, Kronecker powers of vectors often involve redundancy due to symmetric terms. The duplication matrix facilitates the conversion from the unique Kronecker product vector to the standard Kronecker product vector.</p><p><strong>Unique Kronecker Power:</strong></p><p>Given a vector <span>$\mathbf{x} \in \mathbb{R}^n$</span>, the unique Kronecker power is:</p><p class="math-container">\[    \mathbf{x}^{\langle k \rangle} \in \mathbb{R}^{\tbinom{n + k - 1}{k}}\]</p><p>which contains only the unique monomials of degree <span>$k$</span>.</p><p><strong>Standard Kronecker Power:</strong></p><p>The standard Kronecker power is:</p><p class="math-container">\[    \mathbf{x}^{[k]} = \underbrace{\mathbf{x} \otimes \mathbf{x} \otimes \cdots \otimes \mathbf{x}}_{k \text{ times}} \in \mathbb{R}^{n^k}\]</p><p>which includes all possible combinations, including redundant terms.</p><p><strong>Conversion Using the Duplication Matrix:</strong></p><p>The duplication matrix <span>$\mathbf{D}_{n,k}$</span> of order <span>$k$</span> is used to expand the unique Kronecker power to the standard Kronecker power:</p><p class="math-container">\[    \mathbf{x}^{[k]} = \mathbf{D}_{n,k} \mathbf{x}^{\langle k \rangle}\]</p><p>Here, <span>$\mathbf{D}_{n,k}$</span> is a matrix of size <span>$\left(n^k \times \tbinom{n + k - 1}{k}\right)$</span>.</p><p><strong>Example:</strong></p><p>For <span>$n = 2$</span> and <span>$k = 2$</span>, let <span>$\mathbf{x} = [x_1, x_2]^\top$</span>. Then:</p><ul><li><p><strong>Unique Kronecker Power:</strong></p><p class="math-container">\[    \mathbf{x}^{\langle 2 \rangle} = [x_1^2, x_1 x_2, x_2^2]^\top\]</p></li><li><p><strong>Standard Kronecker Power:</strong></p><p class="math-container">\[    \mathbf{x}^{[2]} = [x_1^2, x_1 x_2, x_2 x_1, x_2^2]^\top\]</p></li></ul><p>The duplication matrix <span>$\mathbf{D}_{2,2}$</span> duplicates the mixed term <span>$x_1 x_2$</span> to account for both <span>$x_1 x_2$</span> and <span>$x_2 x_1$</span> in the standard Kronecker power:</p><p class="math-container">\[    \mathbf{x}^{[2]} = \mathbf{D}_{2,2} \mathbf{x}^{\langle 2 \rangle}\]</p><p><strong>Note on Julia Implementation:</strong></p><p>The Julia function <code>dupmat(n::Int, p::Int)</code> generates the duplication matrix of order <code>p</code> for vectors of length <code>n</code>. This function can be used to create the duplication matrix needed for converting unique Kronecker products to standard ones.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniqueKronecker.dupmat" href="#UniqueKronecker.dupmat"><code>UniqueKronecker.dupmat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dupmat(n::Int, p::Int) -&gt; Dp::SparseMatrixCSC{Int}</code></pre><p>Create a duplication matrix of order <code>p</code> for a vector of length <code>n</code> <a href="../../paper/#MagnusEML1980">Magnus and Neudecker [1]</a>.</p><p><strong>Arguments</strong></p><ul><li><code>n::Int</code>: The length of the vector.</li><li><code>p::Int</code>: The order of the duplication matrix, e.g., <code>p = 2</code> for x ⊗ x.</li></ul><p><strong>Output</strong></p><ul><li><code>Dp::SparseMatrixCSC{Int}</code>: The duplication matrix of order <code>p</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; dupmat(2,2)
4×3 SparseMatrixCSC{Int64, Int64} with 4 stored entries:
 1  ⋅  ⋅
 ⋅  1  ⋅
 ⋅  1  ⋅
 ⋅  ⋅  1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/smallpondtom/UniqueKronecker.jl/blob/56b86aa87e4c0bac5307363731eddfd7d9705a5e/src/polytools.jl#L6-L27">source</a></section></article><p><strong>Benefits:</strong></p><ul><li><strong>Expands Unique Terms:</strong> Allows reconstruction of the full Kronecker power from the unique monomials.</li><li><strong>Simplifies Computations:</strong> Facilitates operations that require the full Kronecker power.</li></ul><h2 id="Converting-Between-Operators"><a class="docs-heading-anchor" href="#Converting-Between-Operators">Converting Between Operators</a><a id="Converting-Between-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-Between-Operators" title="Permalink"></a></h2><p>The duplication matrix is also instrumental in converting between non-redundant (unique) and redundant polynomial operators in dynamical systems.</p><p><strong>Unique Operators:</strong></p><p>In the polynomial dynamical system:</p><p class="math-container">\[    \dot{\mathbf{x}}(t) = \mathbf{A} \mathbf{x}(t) + \mathbf{A}_{2u} \mathbf{x}^{\langle 2 \rangle}(t) + \mathbf{A}_{3u} \mathbf{x}^{\langle 3 \rangle}(t) + \cdots\]</p><p>the matrices <span>$\mathbf{A}_{ku} \in \mathbb{R}^{n \times \tbinom{n + k - 1}{k}}$</span> operate on the unique Kronecker powers.</p><p><strong>Redundant Operators:</strong></p><p>Alternatively, using the standard Kronecker powers:</p><p class="math-container">\[    \dot{\mathbf{x}}(t) = \mathbf{A} \mathbf{x}(t) + \mathbf{A}_2 \mathbf{x}^{[2]}(t) + \mathbf{A}_3 \mathbf{x}^{[3]}(t) + \cdots\]</p><p>with <span>$\mathbf{A}_k \in \mathbb{R}^{n \times n^k}$</span>.</p><p><strong>Conversion Using the Duplication Matrix:</strong></p><p>The unique operator <span>$\mathbf{A}_{ku}$</span> and the redundant operator <span>$\mathbf{A}_k$</span> are related through the duplication matrix:</p><p class="math-container">\[    \mathbf{A}_{ku} = \mathbf{A}_{k} \mathbf{D}_{n,k}\]</p><p>which eliminates the redundant terms.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniqueKronecker.eliminate" href="#UniqueKronecker.eliminate"><code>UniqueKronecker.eliminate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eliminate(A::AbstractArray, p::Int)</code></pre><p>Eliminate the redundant polynomial coefficients in the matrix <code>A</code> and return the matrix  with unique coefficients.</p><p><strong>Arguments</strong></p><ul><li><code>A::AbstractArray</code>: A matrix</li><li><code>p::Int</code>: The order of the polynomial, e.g., <code>p = 2</code> for x ⊗ x.</li></ul><p><strong>Returns</strong></p><ul><li>matrix with unique coefficients</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; n = 2; P = rand(n,n); P *= P&#39;; p = vec(P)
4-element Vector{Float64}:
 0.5085988756090203
 0.7704767970682769
 0.7704767970682769
 1.310279680309927

julia&gt; Q = rand(n,n); Q *= Q&#39;; q = vec(Q)
4-element Vector{Float64}:
 0.40940214810208353
 0.2295272821417254
 0.2295272821417254
 0.25503767587483905

julia&gt; A2 = [p&#39;; q&#39;]
2×4 Matrix{Float64}:
 0.257622  0.44721   0.0202203  0.247649
 1.55077   0.871029  0.958499   0.650717

julia&gt; eliminate(A2, 2)
2×3 Matrix{Float64}:
 0.508599  1.54095   1.31028
 0.409402  0.459055  0.255038</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/smallpondtom/UniqueKronecker.jl/blob/56b86aa87e4c0bac5307363731eddfd7d9705a5e/src/polytools.jl#L253-L292">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../elimination/">« Elimination Matrix</a><a class="docs-footer-nextpage" href="../commutation/">Commutation Matrix »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 24 September 2024 20:26">Tuesday 24 September 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
